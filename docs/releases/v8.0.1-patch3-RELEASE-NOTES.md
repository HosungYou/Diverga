# Diverga v8.0.1-patch3 Release Notes

**Release Date**: 2026-02-07
**Type**: Patch (8-Dimension Diagnostic Sweep & Deep Fix)

---

## Summary

v8.0.1-patch3 is the result of a comprehensive 8-dimension diagnostic sweep using multi-agent parallel analysis. The sweep discovered and fixed critical registration bugs (Category I agents missing from TypeScript registry), version drift across 8+ files, and documentation inconsistencies.

## Diagnostic Methodology

8 parallel diagnostic agents analyzed the codebase simultaneously:

| # | Dimension | Agent Type | Model |
|---|-----------|-----------|-------|
| T1 | Version Consistency | explore-high | Opus |
| T2 | Agent Definitions | explore-high | Opus |
| T3 | Build & TypeScript | build-fixer | Sonnet |
| T4 | Code Quality | code-reviewer | Opus |
| T5 | Security Review | security-reviewer | Opus |
| T6 | Architecture | architect | Opus |
| T7 | Documentation | Gemini CLI | gemini-3-pro |
| T8 | Test Coverage | qa-tester | Sonnet |

## Critical Fixes

### 1. Category I Agent Registration Bug
**Impact**: I0-I3 agents (ScholaRAG systematic review pipeline) existed as markdown/skill files but were NOT registered in the TypeScript runtime. Calling `getAgent('i0')` would fail.

**Root Cause**: When Category I was added in v6.7.0, the `agents/*.md` and `skills/` files were created, but:
- `src/agents/types.ts` CategoryId type was `'A' | 'B' | ... | 'H'` (missing 'I')
- `src/agents/definitions.ts` AGENT_MAPPINGS/AGENT_CONFIGS had 40 entries (missing i0-i3)
- `src/index.ts` category() function didn't include 'I'

**Fix**: Added Category I to all TypeScript source files.

### 2. Version Drift (13 files)
VERSION constants ranged from '6.0.0' to '6.6.1' across the codebase. All synchronized to '8.0.1'.

### 3. ESM/CJS Module Fix
Both `src/index.ts` and `lib/index.ts` used CJS `require()` despite `"type": "module"` in package.json. Converted to async ESM `import()`.

### 4. lib/ Category I Gap
`lib/agents/parser.ts` regex `[A-H]` excluded Category I agents from discovery. `lib/agents/types.ts` CATEGORIES record missing 'I'. Both fixed.

## Files Changed (14)

| File | Change |
|------|--------|
| `src/agents/types.ts` | Category 'I' in CategoryId, CATEGORIES, CATEGORY_TOOLS |
| `src/agents/definitions.ts` | i0-i3 AGENT_MAPPINGS + AGENT_CONFIGS (40→44) |
| `src/index.ts` | VERSION 8.0.1, ESM import, category 'I' |
| `lib/index.ts` | VERSION 8.0.1, ESM import |
| `lib/agents/discovery.ts` | version 8.0.1 |
| `lib/agents/types.ts` | Category 'I' in CATEGORIES |
| `lib/agents/parser.ts` | regex [A-H]→[A-I] |
| `packages/codex-setup/src/index.ts` | VERSION 8.0.1 |
| `.opencode/plugins/diverga/index.ts` | version 8.0.1, 44 Agents |
| `.opencode/plugins/diverga/hooks/context-manager.ts` | v8.0.1 |
| `.codex/AGENTS.md` | 44 agents, Category I section |
| `AGENTS.md` | v8.0.1 section headers |
| `README.md` | 44 agents, BibTeX v8.0.1 |
| `lib/memory/IMPLEMENTATION_SUMMARY.md` | 44 agents |

## Architecture Findings (Advisory)

The diagnostic sweep also identified these architectural observations for future consideration:

1. **Dual Registry**: `src/` and `lib/` maintain independent agent registries with incompatible types
2. **lib/ Legacy Status**: `lib/` is not compiled, not in package.json exports — effectively dead code
3. **6 State Systems**: .research/ YAML, lib/memory/ SQLite, lib/hud/, .omc/ JSON — no unified interface
4. **Zero TypeScript Tests**: 168 Python tests exist, but no TypeScript test coverage

## Verification

| Check | Result |
|-------|--------|
| `tsc --noEmit` | 0 errors |
| Stale versions in source | 0 matches |
| Stale agent counts | 0 matches |
| Category I registration | Verified |

## Stats

- 14 files changed, 137 insertions, 40 deletions
- 8 diagnostic dimensions analyzed
- 16+ issues identified and fixed
- 0 TypeScript compilation errors
